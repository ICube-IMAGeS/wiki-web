# Contributing

<!-- For full documentation visit [mkdocs.org](https://www.mkdocs.org).

## Commands

* `mkdocs new [dir-name]` - Create a new project.
* `mkdocs serve` - Start the live-reloading docs server.
* `mkdocs build` - Build the documentation site.
* `mkdocs -h` - Print help message and exit.

## Project layout

    mkdocs.yml    # The configuration file.
    docs/
        index.md  # The documentation homepage.
        ...       # Other markdown pages, images and other files. -->


This page present the basic steps required to contribute to this repo. Its content is fourfold:

1. [how to set up the environment to add content](#setting-up-the-environment)<br>
2. [core principle of this documentation build](#adding-content)<br>
3. [tips and tricks to publish good content](#a-quick-dive-into-good-mkdocs-practices)<br>
4. [understanding auto documentation](#autodocumentation)


## I - Setting up the environment

* First, you need to be a contributor of the [Github repository](https://github.com/ListIndexOutOfRange/WikiImages). Please contact any of the [current contributors](https://github.com/ListIndexOutOfRange/WikiImages/graphs/contributors) to ask for access. Note that the website itself is encrypted. The contributor granting you access should provide you the password as well.
* Then, clone the repo and install the dependencies:
```
git clone git@github.com:ListIndexOutOfRange/WikiImages.git
cd WikiImages
pip install -r docs/requirements.txt
```

## II - Adding content

The entire documentation is built with [Mkdocs](https://www.mkdocs.org/getting-started/), a tool chosen because it is as powerful as it is simple. We strongly encourage you to read the Mkdocs documentation before publishing content. The key idea is that **everything is a markdown**. That is, **any page of this website is a single markdown file**.  The process to add content is then as simple as:<br>

* create a new markdown in the appropriate subfolder within the docs/ folder.<br>
* modify the nav section of the mkdocs.yml file accordingly.<br>


!!! tip
    
    You can see your changes live locally using the `mkdocs serve` command. When everything is ready to be published, simply commit. Remember that clear and detailed commit messages help you stay healthy and in a good mood.


This website uses Material for Mkdocs. You can quickly check up the available formatting [here](https://squidfunk.github.io/mkdocs-material/reference/). There are tons of pretty formatting options. Take the time to read the reference and try to use them wisely in order to make this documention somehow enjoyable to read.


Note that the documentation is built hunder the hood after every single commit[^1]. You can keep track of the build process in the `Actions` panel of the repository. Each commit generates two actions. The changes made appear on the website only when these two processes are finished (which should take ~1mn). The site code itself is generated by mkdocs in a separate branch `gh-pages`. 

[^1]: Check the [.github/workflows/ci.yml](https://github.com/ListIndexOutOfRange/WikiImages/blob/main/.github/workflows/ci.yml) file if you wanna know how it's done.

!!! warning 

    The Mkdocs documentation advices to build the docs using the `mkdocs gh-deploy` command. **Please don't**.
    The documentation is built automatically after a commit. Don't build it yourself.


!!! info "Mkdocs and paths"

    Last things to be aware of: **Mkdocs does not have access to anything outside the `docs/` folder**. That is, you cannot access any folder, images, notebooks, ... outside of the `docs/` folder. This is obviously a big limitation but an easy one to get around: you can create a symlink (command `ln -s`) to the folders or files you want to access. This web page displays a gif from the `assets/` folder thanks to that trick. <br>
    **You must be inside the `docs/` folder to create the symlink**. e.g.:
    ```
    cd docs/
    ln -s ../assets/ .
    ```


## III - A quick dive into good Mkdocs practices


This section is in no way comprehensive. It just wraps up some common use cases. Again, refer to the [Material for Mkdocs documentation](https://squidfunk.github.io/mkdocs-material/reference/) for more infos. 


### 1. Linebreak

Remember that markdown rendering doesn't break line when you do. You can enforce line break by either:

- adding a blank line
- adding tabulation at the end of the line
- adding the `<br>` tag at the end of the line


### 2. Notebooks

This documentation supports jupyter notebook rendering. That is, you can put a `.ipynb` file anywhere within the `docs/` folder and link it in the nav section of the mkdocs.yml file. The notebook will render as a separate web page.


### 3. Latex rendering

You can insert Latex command wether inline by using `$...$` or `\(...\)` or in block by using `$$...$$` or `\[...\]` on separate lines.

=== "MathJax, inline syntax"

    ``` latex
    The homomorphism $f$ is injective if and only if its kernel is only the singleton set $e_G$,
    because otherwise $\exists \, a,b \in G$ with $a\neq b$ such that $f(a)=f(b)$.
    ```

    <div class="result" markdown>

    The homomorphism $f$ is injective if and only if its kernel is only the singleton set $e_G$,<br>
    because otherwise $\exists \, a,b \in G$ with $a\neq b$ such that $f(a)=f(b)$.

    </div>

=== "MathJax, block syntax"

    ``` latex
    $$
    \operatorname{ker} f=\{g\in G:f(g)=e_{H}\}
    $$
    ```

    <div class="result" markdown>

    $$
    \operatorname{ker} f=\{g\in G:f(g)=e_{H}\}
    $$

    </div>


Check [this page](https://squidfunk.github.io/mkdocs-material/reference/mathjax/) for more informations. 


### 4. Code embedding

Code blocks must be enclosed with two separate lines containing three backticks.
To add syntax highlighting to those blocks, add the language shortcode directly
after the opening block. See the [list of available lexers](https://pygments.org/docs/lexers/) to find the
shortcode for a given language:

```` markdown title="Code block"
``` py
import numpy as np
```
````
<div class="result" markdown>

``` py
import numpy as np
```

</div>

That's pretty much it. You can add title, annotations, highlighting, and a bunch of cool stuff. Check [here](https://squidfunk.github.io/mkdocs-material/reference/code-blocks/).


## V. Autodocumentation

This can be seen as the main part of this guide. As any documentation, this website should contains API references, that is a list of available fonctions/classes alongside their parameters and retunrned values. This kind of API references can in fact be generated automatically at almost no cost using this repo. The core idea is that **website pages will be generated (almost) automatically from docstring inside the code**.

### 1. Writing docstrings

The automatic API documentation process expects [**Google style docstring**](https://gist.github.com/redlotus/3bc387c2591e3e908c9b63b97b11d24e). 

??? tip "autodocstring VSCode extension"

    If you're using VSCode, the [autodocstring](https://github.com/NilsJPWerner/autoDocstring) extension helps you generate such docstrings very easily !
    ![](./assets/autodocstring_demo.gif)

### 2. Generating API reference pages

Now for the magic part. You can simply add the following line to a markdown:

` ::: some.module.function.path`

And that's it. The API reference will be generated. For instance, a toy function was created in the `dummy.py` file inside the `code/` folder. So adding
` ::: code.dummy.add` will generate the following:


::: code.dummy.add
    options:
        show_source: false
        show_root_heading: true
      

!!! note

    Unlike any other things in Mkdocs, changes made inside a docstring will not render live locally in the website. You have to shutdown the server and rerun
    `mkdocs serve` in order to see them.


$$
\star\star\star 
$$

That's all for this contribution guide. Hopefully you now have got a good grasp about how this website works and how to add content :sunglasses: .